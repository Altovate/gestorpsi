{% extends "core/main.html" %}

{% comment %}

Copyright (C) 2008 GestorPsi

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

{% endcomment %}

{% load i18n %}

{% block menu_client %}active{% endblock %}

{% block submenu %}
    {% include "client/client_menu.html" %}
{% endblock %}

{% block core %}

<h2 id="title_addressbook" style="display:none"></h2>

{% if object.id %}
	<h2 class="title_clients title">{{ object.person.name }}</h2>
	<p class="description">{% trans "Admission Details" %}<br />	
{% else %}
	<h2 class="title_clients title">{% trans "New Admission" %}</h2>
	<p class="description">{% trans "Inform the client details then click on Save button" %}</p>
{% endif %}

</p>
<h2 id="title_contacts" style="display:none"></h2>
<h2 id="title_myoffice" style="display:none"></h2>

<form action="/admission/{{ object.id }}/save/" method="post" id="client_admission_form" class="ajax form_admission form_client">
<input type="hidden" class="tabtitle" value="{{ object.person.name }}" />
<div class="main_area">
        <!-- <a href="" id=help>&nbsp;</a> -->
        <h3><span onClick="$('form_options').toggle();">{% trans "Admission Details" %}</span></h3>
        <ul id="form_options" class="float_menu" style="display:none;">
                <li><label><input name="this" type="radio" value="" /> Informa&ccedil;&otilde;es b&aacute;sicas</label></li>
                <li><label><input name="this" type="radio" value="" /> Dados completos</label></li>

                <li><label><input name="this" type="radio" value="" /> Prontu&aacute;rio cl&iacute;nico</label></li>
                <li><label><input name="this" type="radio" value="" /> Dados s&oacute;cio-demogr&aacute;ficos</label></li>
                <li><label><input name="this" type="radio" value="" /> Dados s&oacute;cio-economcos</label></li>

                
        </ul>
        <fieldset>
        <legend>{% trans "Basic Informations" %}</legend>
        <label>{% trans "ID Record" %}<br />
        <input name="idRecord" type="text" class="medium" value="{{ object.idRecord }}" readonly="1" /></label>
        <label>{% trans "Legacy Record" %}<br />
        <input name="legacyRecord" maxlength="15" type="text" class="medium" value="{{ object.legacyRecord }}" /></label>
        <label>{% trans "Admission Date" %}<br />
        <input name="admission_date" type="text" class="medium" value="{% if not object.admission_date %}{% now "d/m/Y" %}{% else %}{{ object.admission_date|date:"d/m/Y" }}{% endif %}" mask="99/99/9999" /></label>
        <label>{% trans "Health Document" %}<br />
        <input name="healthDocument" maxlength="15" type="text" class="big" value="{{ object.healthDocument }}" /></label>

        </fieldset>

        <!-- REFERRAL -->
        <div class="admission_referral">
		<fieldset>
		<legend>{% trans "Referrals" %}</legend>
        <label>{% trans "How the client heard about this organization?" %}<br />
                <select name="referral" class="big toggle_parent_label">
                        {% for o in ReferralChoices %}
                                <option value="{{ o.id }}" label="{{ o.nick }}" {% ifequal o.id object.admissionreferral_set.all.0.referral_choice_id %} selected{% endifequal %}>{{ o }}</option>
                        {% endfor %}
                </select>
        </label>

                <!-- show PROF or ORG. if user choose org, hide prof and show org, contrariwise -->

               <div class="admission_ref_org" {% ifnotequal object.admissionreferral_set.all.0.referral_choice_id 7 %} style="display:none;"{% endifnotequal %}>
                <label 	class="organization"> {% trans "Select Organization, or"%}
                     <a class="form_mini" display="address_book_organization_mini">{% trans "add a new one" %}</a><br />
                      <select name="referral_organization" class="select extrabig asm">
                       <option>Escolha...</option>
                        {% for org in list_org %}
                            <option value="{{ org.id }}" {% ifequal org.id object.admissionreferral_set.all.0.referral_organization_id %} selected {% endifequal %}>{{ org }}</option>
                        {% endfor %}
                      </select>
                </label>
               </div>
                    
               <div class="admission_ref_prof" {% ifnotequal object.admissionreferral_set.all.0.referral_choice_id 8 %} style="display:none;" {% endifnotequal %} >
                <label 	class="professional"> {% trans "Select Professional, or"%}
                     <a class="form_mini" display="address_book_professional_mini">{% trans "add a new one" %}</a><br />
                      <select name="referral_professional" class="select extrabig asm">
                       <option>Escolha...</option>
                        {% for prof in list_prof %}
                            <option value="{{ prof.id }}" {% ifequal prof.id object.admissionreferral_set.all.0.referral_professional_id %} selected {% endifequal %}>{{ prof }}</option>
                        {% endfor %}
                      </select>
                </label>
               </div>
        </fieldset>
       </div>
       <!-- REFERRAL -->

        <!-- INDICATION -->
        <div class="admission_indication">
	     <fieldset>
	      <legend>{% trans "Indications" %}</legend>
	       <label>{% trans "Indication done by" %}<br />
				<select name="indication" class="big toggle_parent_label">
                        {% for o in IndicationsChoices %}
                                <option value="{{ o.id }}" label="{{ o.nick }}" {% ifequal o.id object.indication_set.all.0.indication_choice_id %} selected{% endifequal %}>{{ o }}</option>
                        {% endfor %}
				</select>
           </label>

        <div class="admission_ind_org" {% ifnotequal object.indication_set.all.0.indication_choice_id 3 %} style="display:none;" {% endifnotequal %} >
		 <label class="organization">{% trans "Select Organization, or"%} <a class="form_mini" display="address_book_organization_mini">{% trans "add a new one" %}</a><br />
		  <select name="indication_organization" class="select extrabig asm">
				<option>Escolha...</option>
				{% for org in list_org %}
                    <option value="{{ org.id }}" {% ifequal org.id object.indication_set.all.0.referral_organization_id %} selected {% endifequal %}>{{ org }}</option>
				{% endfor %}
		  </select>
		 </label>
        </div>

        <div class="admission_ind_prof" {% ifnotequal object.indication_set.all.0.indication_choice_id 4 %} style="display:none;" {% endifnotequal %} >
		 <label class="professional">{% trans "Select Professional, or"%} <a class="form_mini" display="address_book_professional_mini">{% trans "add a new one" %}</a><br />
		  <select name="indication_professional" class="select extrabig asm">
				<option>Escolha...</option>
				{% for prof in list_prof %}
				    <option value="{{ prof.id }}" {% ifequal prof.id object.indication_set.all.0.referral_professional_id %} selected {% endifequal %}>{{ prof }}</option>
				{% endfor %}
		  </select>
		 </label>
        </div>

       </fieldset>
      </div>
      <!-- INDICATION -->

        <fieldset>
                <legend>{% trans "Parents" %}</legend>
                        {% if not object.person_link.all %}
                                {% include "tags/people_parent.html" %}
                        {% else %}
                                {% for p in object.person_link.all %}
                                        {% include "tags/people_parent.html" %}
                                {% endfor %}
                        {% endif %}
                <a class="add_to_form"><span>{% trans "Add Parent" %}</span></a>
        </fieldset>

        <fieldset style="display:none">
        <legend>{% trans "Forwards" %}</legend>
        <label>{% trans "Please, select a professional from the list bellow or" %}, <a class="form_mini" display="careprofessional_mini">{% trans "add a new one" %}</a></label>
        <div class="overflow">

                <table id="indicators" class="zebra">
                        <thead>
                        <tr><th></th><th></th><th></th></tr>
                        </thead>
                        <tbody>
                        {% for p in CareProfessionals %}
                        <tr>
                                <td><a href="">{{ p }}</a></td>
                                <td>Psic√≥logo</td>
                                <td>{{ p.person.get_first_phone }}</td>
                        </tr>
                        {% endfor %}
                        </tbody>
                </table>
        </div>


        <label>{% trans "Admission reason" %}<br />
        <textarea name="" cols="" rows="3" class="giant"></textarea></label>

        </fieldset>

        <fieldset>
        <label>{% trans "Comments" %}<br />
        <textarea name="comments" cols="" rows="8" class="giant">{{ object.comments }}</textarea></label>

        </fieldset>
</div>

<div id="sidebar" class="sidebar">
    {% if perms.client.client_write %}
        <div class="bg_blue">
            {% include "tags/save.html" %}
        </div>
    {% endif %}
    {% if object.id %}
        {% include "tags/client_sidebar.html" %}
    {% endif %}
</div>
</form>


{% include "tags/address_book_professional_mini.html" %}
{% include "tags/address_book_organization_mini.html" %}

{% endblock %}

