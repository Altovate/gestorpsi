{% extends "core/main.html" %}

{% comment %}

Copyright (C) 2008 GestorPsi

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

{% endcomment %}

{% load i18n %}

{% block menu_client %}active{% endblock %}

{% block submenu %}
    {% include "client/client_menu.html" %}
{% endblock %}

{% block core %}

<input type="hidden" name="object_id" value="{{ object.id }}" />
<h2 class="title_clients title">{% trans "Diagnoses" %} - {{ referral }} ({{ referral.professional_list|join:", " }})</h2>
<p class="description"><a href="/client/{{ object.id }}/{{ referral.id }}/diagnosis/add/">{% trans "Add new diagnosis" %}</a><br /></p>


{% if not diagnoses %}

<div id="msg_area" class="alert no_registers_available">
    {% trans "There is no registers available." %}<br /><br />{% trans "Click" %} <a href="/client/{{ object.id }}/{{ referral.id }}/diagnosis/add/" display="form" class="fastmenu notajax" sub_menu="sub_employees">{% trans "here" %}</a> {% trans "if you want to add a new one." %}
</div>

{% else %}

<div class="main_area contact">
    <table id="search_results" class="zebra newtab" border="0" cellspacing="0" cellpadding="0">
        <thead> 
            <tr> 
                <th></th> 
                <th></th>
                <th></th>
            </tr> 
        </thead>
        <tbody>
            {% for diagnosis in diagnoses %}
                <tr class="{% cycle 'zebra_0' 'zebra_1' %}">
                    <td>
                        <span class="phone"><a href="/client/{{ object.id }}/{{ referral.id }}/diagnosis/{{ diagnosis.id }}/"><i>{% trans "Diagnosis" %}</i></a></span><br />
                        <a href="/client/{{ object.id }}/{{ referral.id }}/diagnosis/{{ diagnosis.id }}/">{{ diagnosis }}</a><br />
                        {{ diagnosis.get_diagnosis_status_display }} - {{ diagnosis.get_diagnosis_status2_display }}<br />
                        {{ diagnosis.get_edit_status_display }}<br />
                    </td>
                    <td></td>
                    <td class="title">
                        {% if diagnosis.occurrence %}
                            {{ diagnosis.occurrence.start_time|date:"d/m/Y" }}<br />
                            {{ diagnosis.occurrence.room }}<br />
                            {{ diagnosis.occurrence.event.referral }}<br />
                            {{ diagnosis.occurrence.event.referral.professional_list|join:", " }}<br />
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endif %}


<div id="sidebar" class="sidebar">
    {% include "tags/client_sidebar.html" %}
</div>

{% endblock %}
