{% extends "core/main.html" %}

{% comment %}

Copyright (C) 2008 GestorPsi

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

{% endcomment %}

{% load i18n %}

{% block menu_myoffice %}active{% endblock %}

{% block vertical_menu %} - {% trans "Services" %}{% endblock %}

{% block submenu %}
    <ul>
        <li><a class="first" href="/service/">{% trans "all" %}</a></li>
        <li><a class="{% if not object.id %}active{% endif %}" href="/service/add/">{% trans "add" %}</a></li>
        {% if object.id %}<li><a class="active">{{ object.name }}</a></li>{% endif %}
        
    </ul>
{% endblock %}


{% block core %}

{% if object.id %}
	<h2 class="title_services title">{{ object.name }}</h2>
	<p class="description">{{ object.description }}<br />	
{% else %}
	<h2 class="title_services title">{% trans "Adding New Service" %}</h2>
	<p class="description">{% trans "Inform the service details then click on Save button" %}</p>
{% endif %}
</p>

<form action="/service/{% if object.id %}{{ object.id }}/{% endif %}save/" method="post" id="form_service" class="form_service">	
<div class="main_area">

	<!-- <a href="" id="help">&nbsp;</a> -->

	<!--
	Service Identification 
	-->
	
	<fieldset>
		<legend>{% trans "Service Identification" %}</legend>
			<label>{% trans "Service Name" %}<br />
			<input type="text" maxlength="80"  name="service_name" class="giant tabtitle" value="{{ object.name }}" />
			</label>
			<label>{% trans "Service Description" %}<br />
				<textarea name="service_description" maxlength="999" class="giant object_description">{{ object.description }}</textarea>				
			</label>
			<label>{% trans "Keywords (separated by ;)" %}<br />
			<input type="text" maxlength="100" name="service_keywords" class="giant" value="{{ object.keywords }}" />
			</label>
    </fieldset>
    <fieldset>
		<legend>{% trans "Research Project" %}</legend>
            <label>
                <input class="research_project_name" type="checkbox" name="research_project"{% if object.research_project %} checked{% endif %} />&nbsp;
                {% trans "This service is linked with a research project" %} 
            </label>
                <div class="research_project_name" {% if object.research_project_name %} style="display:block;" {% else %} style="display:none;" {% endif %}>
                    <label> 
                        {% trans "Name" %}
			            <input type="text" maxlength="100" name="research_project_name" class="giant" value="{{ object.research_project_name }}" />
                    </label>
                </div>
            
	</fieldset>

	<!--
	Service Profile 
	-->
	
	<fieldset>
		<legend>{% trans "Service Profile" %}</legend>
	
		<label>{% trans "Area" %}<br>
		<select name="service_area" class="extramedium service_area">
			{% for a in Areas %}
				{% if a.modality.values_list %}
				<option value="{{ a.id }}"{% ifequal a.id object.area.id %} selected{% endifequal %}>{{ a }}</option>
				{% endif %}
			{% endfor %}
		</select>
		</label>
		
		
		<label>{% trans "Type" %}<br />
		<select name="service_type" class="extramedium service_type">
			{% for s in ServiceTypes %}
			<option value="{{ s.id }}" area="{{ s.area.id }}"{% ifequal s.id object.service_type.id %} selected{% endifequal %}>{{ s }} </option>
			{% endfor %}
		</select>
		</label>

		<label>{% trans "Solicitation" %}<br />
		<select name="service_solicitation" class="extramedium service_solicitation multiple asm" multiple="multiple">
			{% for m in Modalitys %}
			<option value="{{ m.id }}" class="{% for a in Areas %}{% for am in a.modality.values_list %}{% ifequal m.id am.0 %}area_{{ a.id }} {% endifequal %}{% endfor %}{% endfor %}"{% for om in object.modalities.values_list %}{% ifequal om.0 m.id %} selected="selected"{% endifequal %}{% endfor %}>{{ m }}</option>
			{% endfor %}
		</select>
		</label>
		
		<label>{% trans "Profession" %}<br />
		<select name="service_profession" multiple="multiple" class="high multiple giant">
			{% for p in Professions %}
				<option value="{{ p.id }}"{% for op in object.professions.all %}{% ifequal op.id p.id %} selected="selected"{% endifequal %}{% endfor %}>{{ p }}</option>
			{% endfor %}			
		</select>
		</label>

	<!--</fieldset>
	
	<fieldset class="service_areas area_3">-->
    <div class="service_areas area_3{% ifnotequal object.area.id 3 %} hidden{% endifnotequal %}">
		<!--<legend>{% trans "Clinica Area" %}</legend>-->
	
		<label>{% trans "Age" %}<br />
		<select name="service_age" multiple="multiple" class="multiple asm">
		{% for l in AgeGroups %}
			<option value="{{ l.id }}"{% for ag in object.content_object.age_group.all %}{% ifequal ag.id l.id %} selected="selected"{% endifequal %}{% endfor %}>{{ l }}</option>
		{% endfor %}
		</select>
		</label>
	</div>
    </fieldset>

{% comment %}
		
	<fieldset>
		<legend>{% trans "Service Procedures" %}</legend>

		<!-- procedures providers to choice -->
		<label>
		{% for l in ProcedureProviders %}
			<a class="notajax select_multiple_menu" display="service_procedure_{{ l.name }}">{{ l.name }}</a>
		{% endfor %}
		<br />
		<!-- procedures itens -->
		{% for l in Procedures %}
			{% ifchanged l.procedure %}
				{% if not forloop.first %}
				</select>
				{% endif %}
				
				<select multiple="multiple" class="service_procedure_{{ l.procedure.name }} extrabig multiple itens_available small_fonts{% if forloop.first %} first{% endif %}">
			{% endifchanged %}
				<option value="{{ l.id }}"{% for p in object.procedures.values_list %}{% ifequal p.0 l.id %} style="display:none"{% endifequal %}{% endfor %}>{{ l.description }}</option>
	
			{% if forloop.last %}
				</select>
			{% endif %}
		{% endfor %}
		
		</label>
		
		<!-- itens choiced -->
		
		<label>{% trans "Procedures Choiced" %}<br />
		<select name="service_type_procedure" multiple="multiple" group="service_procedure" class="extrabig multiple itens_selected small_fonts">
		{% for p in object.procedures.values_list %}
		<option value="{{ p.0 }}" selected="selected">{{ p.2 }}</option>
		{% endfor %}
		</select>
		
		</label>
		
		
			
	</fieldset>
	
{%  endcomment %}
	
	<!--
	Services Relations
	-->
	
	<fieldset>
		<legend>{% trans "Service Relations" %}</legend>
	
			<label>{% trans "Agreements" %}<br />
			<span>
			<select multiple="multiple" name="service_agreements" class="select multiple extrabig asm high">
				{% for l in Agreements %}
				<option value="{{ l.id }}"{% for oa in object.agreements.values_list %}{% ifequal oa.0 l.id %} selected="selected"{% endifequal %}{% endfor %}>{{ l }}</option>
				{% endfor %}
			</select>
			</span>
			</label>
	
			<label>{% trans "Related Professionals" %}<br />
			<span>
			<select multiple="multiple" name="service_professionals" class="select multiple extrabig asm high">
				{% for l in CareProfessionals %}
				<option value="{{ l.id }}"{% for or in object.professionals.values_list %}{% ifequal or.0 l.id %} selected="selected"{% endifequal %}{% endfor %}>{{ l }}</option>
				{% endfor %}
			</select>
			</span>
			</label>

			<label>{% trans "Professionals Responsible" %}<br />
			<span>
			<select multiple="multiple" name="service_responsibles" class="select multiple extrabig asm high">
				{% for l in CareProfessionals %}
				<option value="{{ l.id }}"{% for or in object.responsibles.values_list %}{% ifequal or.0 l.id %} selected="selected"{% endifequal %}{% endfor %}>{{ l }}</option>
				{% endfor %}
			</select>
			</span>
			</label>
		
	</fieldset>	
	
	<!--
	Service must to have a status
	-->
	
<fieldset class="comment_form">
        <legend>{% trans "Comments" %}</legend>
        <label>{% trans "Comments" %}<br />
                <textarea name="comments" class="extrabig">{{ object.comments }}</textarea>
        </label>
</fieldset>


<br />	
</div>

<div id="sidebar" class="sidebar">
    {% if perms.service.service_write %}
    	<div class="bg_blue">
        	<input type="hidden" name="service" value="{{ object.id }}" />
            {% include "tags/save.html" %}
        </div>
    {% endif %}
    {% if object.id %}
        {% include "tags/service_sidebar.html" %}
    {% endif %}
</div>

</form>

{% endblock %}


