{% extends "core/main.html" %}

{% comment %}

Copyright (C) 2008 GestorPsi

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

{% endcomment %}

{% load i18n %}

{% block menu_myoffice %}active{% endblock %}

{% block vertical_menu %} - {% trans "Users" %}{% endblock %}

{% block submenu %}
    <ul>
        <li><a class="first" href="/user/">{% trans "all" %}</a></li>
        <li><a class="{% if not profile %}active{% endif %}" href="/user/add/">{% trans "add" %}</a></li>
        <li><a href="/user/deactive/">{% trans "all Deactive" %}</a></li>

        {% if profile %}<li><a class="active">{{ profile.person.name }}</a></li>{% endif %}
        
    </ul>
{% endblock %}


{% block core %}

<h2 id="title_addressbook" style="display:none"></h2>

{% if profile.id %}
	<h2 class="title_clients title">{{ profile.person.name }}</h2>
    <p class="description">{{ profile.user.username }} {{ profile.user.email }}<br />
{% else %}
	<h2 class="title_clients title">{% trans "Adding New User" %}</h2>
	<p class="description">{% trans "Inform the user details then click on Save button" %}</p>
{% endif %}


<h2 id="title_contacts" style="display:none"></h2>
<h2 id="title_myoffice" style="display:none"></h2>

{% if profile.id %}
    <form action="/user/{{ profile.person.id }}/save/" method="post" id="form_user" class="form_user">
{% else %}
    <form action="/user/save/" method="post" id="form_user" class="form_user">
{% endif %}

<div class="main_area">

	<!-- <a href="" id="help">&nbsp;</a> -->
	<!-- DataTypes form menu -->
	<h3><span id="client_add_infotypes">{% trans "User registration" %}</span></h3>
	<ul id="form_options" class="float_menu" style="display:none;">
		<li><label><input name="this" type="radio" value="" checked/>{% trans "User registration" %}</label></li>
	</ul>

<fieldset>
        <legend>{% trans "Personal Identification" %}</legend>
                <label>{% trans "Name" %}<br />
                        {% if person_list %} 
                                    <select name="id_person" class="giant get_user_json">
                                    <option value=""></option>
                                        {% for o in person_list %}
                                            <option id="" value="{{ o.id }}"> {{ o.name }} </option>
                                        {% endfor %}
                                    </select>
                            {% else %}
                            <input type="text" class="giant" readonly="1" value="{{ profile.person.name }}">
                        {% endif %}
                </label>

                <label>{% trans "Username" %}<br />
                    <input type="text" name="username" class="giant" value="{{ profile.user.username }}" id="id_username" {% if profile.user.username %} readonly="1" {% endif %} />
                </label>

                {% if profile.id %}
                    <label><a class="form_mini" display="pwd_mini">{% trans "Change Password" %}</a>
                    </label>
                {% else %}
                    <label>{% trans "Password" %}<br />
                        <input type="password" name="password" class="extramedium" value="" id="id_password" />
                    </label>
                    <label>{% trans "Password" %} <small>({% trans "Again" %})</small><br />
                         <input type="password" name="pwd_conf" class="extramedium" value="" id="id_pwd_conf" />
                     </label>
                {% endif %}


		{% if profile.user.email %}
			<label style="clear: both;">
				{% trans "Registered user e-mail" %}<br />
				<input type="text" name="email" value="{{ profile.user.email }}" class="extramedium"  readonly>
			</label>
		{% else %}
			{% if emails %}
				<label>
					{% trans "Select one e-mail to procede with your registration" %}<br />
					<select name="email" id="email">
						{% for email in emails %}
							<option class="email_send_user" name="email_send_user" value="{{ email }}">&nbsp;{{ email }}&nbsp;</option>
						{% endfor %}
					</select>
				</label>
			{% else %}
				<label>
					{% trans "Type an e-mail to procede with your registration" %}<br />
					<input class="extramedium email_send_user" type="text" name="email_send_user" value="">
				</label>
			{% endif %}		    
		{% endif %}
		

</fieldset>

<!-- TO BE IMPLEMENTED!
<fieldset>
        <legend>{% trans "Expiration Date" %}</legend>
        <label>{% trans "Expiration Date" %}<br />
        <input type="text" class="calendar" name="expiration_date" value="{{ profile.person.birthDate|date:"d/m/Y" }}" mask="99/99/9999" />
</fieldset>
-->

<fieldset>
        {% ifequal show "True" %}
            <legend>{% trans "Role" %} {{ list_adm }}</legend>
                <h4 align="center">{% trans "You are the only Administrator on organization. You can't change your permission at this time." %} </h4>
        {% else %}
                <legend>{% trans "Role" %}</legend>
                <h2 class="title_clients title">{% trans "Permissions" %}</h2>
                <p><input class="group" type="checkbox" id="1" name="perms" value="administrator" {% if groups.0 %}checked{% endif %}>{% trans "Administrator" %}</p>
                <p><input class="group" type="checkbox" id="2" name="perms" value="professional" {% if groups.1 %}checked{% endif %}>{% trans "Professional" %}</p>
                <p><input class="group" type="checkbox" id="3" name="perms" value="secretary" {% if groups.2 %}checked{% endif %}>{% trans "Secretary" %}</p>
                <p><input class="group" type="checkbox" id="4" name="perms" value="client" {% if groups.3 %}checked{% endif %}>{% trans "Client" %}</p>
         {% endifequal %}
</fieldset>
	
<br />	
</div>

<div id="sidebar" class="sidebar">
	<div class="bg_blue">
		{% include "tags/save.html" %}
	</div>
        {% include "tags/user_sidebar.html" %}
</div>

</form>

<div class="form_mini pwd_mini">
    <form action="/user/{{ profile.person.id }}/savepwd/" method="post" class="pwd">
        <fieldset>
            <legend>{% trans "Change password" %}</legend>

            <div id="msg_area" class="error" style="opacity: 1; display: none;">{% trans "Password not match. Try again."%}</div>

            <label>{% trans "Password" %}<br />
                <input type="password" name="password_mini" class="big" value=""     />
            </label>
            <label>{% trans "Password" %} <small>({% trans "Again" %})</small><br />
                <input type="password" name="password_mini_conf" class="big tabtitle" value=""    />
            </label>
            <label>
                 <input type="submit" name="submit" value="{% trans "Change" %}" class="mini" />
                 <input type="submit" name="cancel" value="{% trans "Cancel" %}" class="mini cancel" />
            </label>
        </fieldset>
    </form>
</div>


{% endblock %}
